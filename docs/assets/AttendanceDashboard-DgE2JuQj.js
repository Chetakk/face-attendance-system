import{e as d,r,s as c,j as e}from"./index-B5QmgcMj.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],v=d("calendar",j);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],k=d("trending-up",w);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],S=d("users",_);function E(){const[o,l]=r.useState([]),[x,m]=r.useState(!0),[n,h]=r.useState({totalToday:0,totalUsers:0,averageConfidence:0});r.useEffect(()=>{g(),p()},[]);const g=async()=>{try{const{data:t,error:s}=await c.from("attendance_records").select(`
          *,
          users (
            name,
            email
          )
        `).order("check_in_time",{ascending:!1}).limit(50);if(s)throw s;l(t||[])}catch(t){console.error("Error fetching records:",t)}finally{m(!1)}},p=async()=>{try{const t=new Date;t.setHours(0,0,0,0);const{data:s,error:a}=await c.from("attendance_records").select("face_match_confidence").gte("check_in_time",t.toISOString());if(a)throw a;const{count:f,error:i}=await c.from("users").select("*",{count:"exact",head:!0});if(i)throw i;const u=s&&s.length>0?s.reduce((N,b)=>N+Number(b.face_match_confidence),0)/s.length:0;h({totalToday:(s==null?void 0:s.length)||0,totalUsers:f||0,averageConfidence:u})}catch(t){console.error("Error fetching stats:",t)}},y=t=>new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Attendance Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(v,{className:"text-blue-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-700",children:"Today's Attendance"})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:n.totalToday})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-6 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(S,{className:"text-green-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-700",children:"Total Users"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:n.totalUsers})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-6 border border-orange-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(k,{className:"text-orange-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-700",children:"Avg Confidence"})]}),e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:[n.averageConfidence.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Confidence"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Loading records..."})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No attendance records found"})}):o.map(t=>{var s,a;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:((s=t.users)==null?void 0:s.name)||"Unknown"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((a=t.users)==null?void 0:a.email)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y(t.check_in_time)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:[Number(t.face_match_confidence).toFixed(1),"%"]})})]},t.id)})})]})})})]})}export{E as default};
